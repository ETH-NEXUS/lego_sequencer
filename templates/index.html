{% extends 'base.html' %}

{% block style %}
<style>
.brick_tray {
    margin: 10px;
}
</style>
{% endblock %}

{% block script %}
<script>
$(document).ready(function() {
    $("#query_ev3").click(function() {
        // $("#response").html("polling...");

        fetch('/query_ev3')
            .then(function(response) {
                response.json().then(function (data) {

                    if (data.error) {
                        console.warn(data.error);
                        return;
                    }

                    console.log(data);

                    const $tray = $("<div />").addClass("brick_tray");

                    $tray.append(data.map(function (x) {
                        return $('<div />')
                            .addClass('brick_tile brick_' + x.color)
                            .html('&nbsp;')
                    }));

                    $("#results_panel").append($tray);
                });
            });
    });
});
</script>
{% endblock %}


{% block body %}
<h1>LEGO Sequencer</h1>

<p></p>

<div>
    <button class="btn btn-primary" id="query_ev3">Scan Elements</button>
</div>

<div id="results_panel" style="padding: 5px;">
    <div class="brick_tray">
        <div id="response">...</div>
    </div>
</div>
{% endblock %}
